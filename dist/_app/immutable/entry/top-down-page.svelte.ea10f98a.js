import{S as Z,i as $,s as x,k as v,q as A,a as M,l as b,m as E,r as F,h as p,c as C,n as I,b as O,F as d,G as Y,N as W,E as z,u as B,O as de,P as X,Q as Me,R as Ce,T as Ge,w as j,U as N,y as te,M as Re,z as ne,A as le,V as H,g as ie,d as re,B as oe}from"../chunks/index.2112c2c0.js";import{_ as Ae}from"../chunks/recipes.93e3cb00.js";import{I as Fe}from"../chunks/item_pages.b3f24859.js";const se=Se(Oe()),Q=Le(se);function Oe(){const r=[],e=new Set;for(const n of Ae.filter(t=>!t.isAlternate).filter(t=>!t.recipe.includes("Unpackage")))e.has(n.recipe)||r.push(n),e.add(n.recipe);return r}function Se(r){return r.map(e=>({product:e.products[0],byproduct:e.products.length>1?e.products[1]:null,ingredients:e.ingredients})).reduce((e,n)=>(e[n.product.item]||(e[n.product.item]=n),e),new Object)}function Le(r){const e={};function n(t){return e[t]?e[t]:r[t]?(e[t]=r[t].ingredients.map(l=>n(l.item)).reduce((l,o)=>Math.max(l,o),0)+1,e[t]):(e[t]=0,0)}for(const t of Object.keys(r))n(t);return e}function De(r,e=0){if(!se[r]){const i=me(e/60);return{product:{item:r,amountPerMinute:i*60},count:i,byproduct:null,ingredients:[]}}const n=se[r];e||(e=n.product.amountPerMinute);const t=me(e/n.product.amountPerMinute);e=t*n.product.amountPerMinute;const l=n.byproduct?{item:n.byproduct.item,amountPerMinute:n.byproduct.amountPerMinute*t}:null,o=n.ingredients.map(i=>De(i.item,i.amountPerMinute*t));return{product:{item:r,amountPerMinute:e},count:t,byproduct:l,ingredients:o}}function me(r){return r%1==0?r:Math.ceil(r*100)/100}function he(r,e,n){const t=r.slice();return t[3]=e[n],t[5]=n,t}function pe(r,e,n){const t=r.slice();return t[6]=e[n],t[8]=n,t}function _e(r){let e,n,t,l,o,i,s=r[6].item+"",c,f,a,u=r[6].count.toFixed(2)+"",m,T,h,k=r[6].amount.toFixed(2)+"",y,P;return{c(){e=v("td"),n=v("div"),t=v("img"),o=M(),i=v("div"),c=A(s),f=M(),a=v("div"),m=A(u),T=M(),h=v("div"),y=A(k),P=A(" / min"),this.h()},l(D){e=b(D,"TD",{class:!0});var g=E(e);n=b(g,"DIV",{});var V=E(n);t=b(V,"IMG",{src:!0,alt:!0,class:!0}),V.forEach(p),o=C(g),i=b(g,"DIV",{});var L=E(i);c=F(L,s),L.forEach(p),f=C(g),a=b(g,"DIV",{});var q=E(a);m=F(q,u),q.forEach(p),T=C(g),h=b(g,"DIV",{});var S=E(h);y=F(S,k),P=F(S," / min"),S.forEach(p),g.forEach(p),this.h()},h(){z(t.src,l=r[0][r[6].item])||I(t,"src",l),I(t,"alt",""),I(t,"class","svelte-10r3h13"),I(e,"class","svelte-10r3h13")},m(D,g){O(D,e,g),d(e,n),d(n,t),d(e,o),d(e,i),d(i,c),d(e,f),d(e,a),d(a,m),d(e,T),d(e,h),d(h,y),d(h,P)},p(D,g){g&3&&!z(t.src,l=D[0][D[6].item])&&I(t,"src",l),g&2&&s!==(s=D[6].item+"")&&B(c,s),g&2&&u!==(u=D[6].count.toFixed(2)+"")&&B(m,u),g&2&&k!==(k=D[6].amount.toFixed(2)+"")&&B(y,k)},d(D){D&&p(e)}}}function ge(r){let e,n,t=r[3],l=[];for(let o=0;o<t.length;o+=1)l[o]=_e(pe(r,t,o));return{c(){e=v("tr");for(let o=0;o<l.length;o+=1)l[o].c();n=M()},l(o){e=b(o,"TR",{});var i=E(e);for(let s=0;s<l.length;s+=1)l[s].l(i);n=C(i),i.forEach(p)},m(o,i){O(o,e,i);for(let s=0;s<l.length;s+=1)l[s]&&l[s].m(e,null);d(e,n)},p(o,i){if(i&3){t=o[3];let s;for(s=0;s<t.length;s+=1){const c=pe(o,t,s);l[s]?l[s].p(c,i):(l[s]=_e(c),l[s].c(),l[s].m(e,n))}for(;s<l.length;s+=1)l[s].d(1);l.length=t.length}},d(o){o&&p(e),W(l,o)}}}function Ue(r){let e,n,t,l,o,i,s=r[1],c=[];for(let f=0;f<s.length;f+=1)c[f]=ge(he(r,s,f));return{c(){e=v("div"),n=v("h2"),t=A("Overall production summary"),l=M(),o=v("table"),i=v("tbody");for(let f=0;f<c.length;f+=1)c[f].c();this.h()},l(f){e=b(f,"DIV",{});var a=E(e);n=b(a,"H2",{class:!0});var u=E(n);t=F(u,"Overall production summary"),u.forEach(p),l=C(a),o=b(a,"TABLE",{});var m=E(o);i=b(m,"TBODY",{});var T=E(i);for(let h=0;h<c.length;h+=1)c[h].l(T);T.forEach(p),m.forEach(p),a.forEach(p),this.h()},h(){I(n,"class","svelte-10r3h13")},m(f,a){O(f,e,a),d(e,n),d(n,t),d(e,l),d(e,o),d(o,i);for(let u=0;u<c.length;u+=1)c[u]&&c[u].m(i,null)},p(f,[a]){if(a&3){s=f[1];let u;for(u=0;u<s.length;u+=1){const m=he(f,s,u);c[u]?c[u].p(m,a):(c[u]=ge(m),c[u].c(),c[u].m(i,null))}for(;u<c.length;u+=1)c[u].d(1);c.length=s.length}},i:Y,o:Y,d(f){f&&p(e),W(c,f)}}}function Pe(r,e){[e.product].forEach(n=>{if(n){r[n.item]||(r[n.item]={item:n.item,count:0,amount:0});const t=r[n.item];t.count+=e.count,t.amount+=n.amountPerMinute}}),e.ingredients.forEach(n=>Pe(r,n))}function Be(r,e,n){let{productionTree:t}=e,{images:l}=e,o=[];return r.$$set=i=>{"productionTree"in i&&n(2,t=i.productionTree),"images"in i&&n(0,l=i.images)},r.$$.update=()=>{if(r.$$.dirty&6&&t){let i={};Pe(i,t);const s=Q[t.product.item];n(1,o=Array(s+1).fill("").map(c=>new Array)),Object.values(i).forEach(c=>{const f=c.item,a=Q[f];o[s-a].push(c)})}},[l,o,t]}class qe extends Z{constructor(e){super(),$(this,e,Be,Ue,x,{productionTree:2,images:0})}}function ve(r,e,n){const t=r.slice();return t[9]=e[n],t}function be(r){let e,n=r[1],t=[];for(let l=0;l<n.length;l+=1)t[l]=Te(ve(r,n,l));return{c(){e=v("ul");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=b(l,"UL",{id:!0,class:!0});var o=E(e);for(let i=0;i<t.length;i+=1)t[i].l(o);o.forEach(p),this.h()},h(){I(e,"id","autocomplete-items-list"),I(e,"class","svelte-kr3isb")},m(l,o){O(l,e,o);for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(e,null)},p(l,o){if(o&18){n=l[1];let i;for(i=0;i<n.length;i+=1){const s=ve(l,n,i);t[i]?t[i].p(s,o):(t[i]=Te(s),t[i].c(),t[i].m(e,null))}for(;i<t.length;i+=1)t[i].d(1);t.length=n.length}},d(l){l&&p(e),W(t,l)}}}function Te(r){let e,n=r[9]+"",t,l,o;function i(){return r[6](r[9])}return{c(){e=v("li"),t=A(n),this.h()},l(s){e=b(s,"LI",{class:!0});var c=E(e);t=F(c,n),c.forEach(p),this.h()},h(){I(e,"class","autocomplete-items svelte-kr3isb")},m(s,c){O(s,e,c),d(e,t),l||(o=X(e,"click",i),l=!0)},p(s,c){r=s,c&2&&n!==(n=r[9]+"")&&B(t,n)},d(s){s&&p(e),l=!1,o()}}}function je(r){let e,n,t,l,o,i,s,c,f,a=r[1].length>0&&be(r);return{c(){e=v("div"),n=v("form"),t=v("div"),l=v("input"),o=M(),i=v("input"),s=M(),a&&a.c(),this.h()},l(u){e=b(u,"DIV",{});var m=E(e);n=b(m,"FORM",{autocomplete:!0});var T=E(n);t=b(T,"DIV",{class:!0});var h=E(t);l=b(h,"INPUT",{id:!0,type:!0,placeholder:!0}),h.forEach(p),o=C(T),i=b(T,"INPUT",{type:!0}),T.forEach(p),s=C(m),a&&a.l(m),m.forEach(p),this.h()},h(){I(l,"id","final-product"),I(l,"type","text"),I(l,"placeholder","Write item names here"),I(t,"class","autocomplete"),I(i,"type","submit"),i.hidden=!0,I(n,"autocomplete","off")},m(u,m){O(u,e,m),d(e,n),d(n,t),d(t,l),de(l,r[0]),d(n,o),d(n,i),d(e,s),a&&a.m(e,null),c||(f=[X(l,"input",r[5]),X(l,"input",r[3]),X(n,"submit",Me(r[2]))],c=!0)},p(u,[m]){m&1&&l.value!==u[0]&&de(l,u[0]),u[1].length>0?a?a.p(u,m):(a=be(u),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i:Y,o:Y,d(u){u&&p(e),a&&a.d(),c=!1,Ce(f)}}}function Ne(r,e,n){const t=Object.keys(Fe),l=Ge();let{inputValue:o=""}=e,i=[];function s(){l("submit")}function c(){o?n(1,i=t.filter(m=>m.toLowerCase().includes(o.toLowerCase()))):n(1,i=[])}function f(m){n(0,o=m),n(1,i=[]),s()}function a(){o=this.value,n(0,o)}const u=m=>f(m);return r.$$set=m=>{"inputValue"in m&&n(0,o=m.inputValue)},[o,i,s,c,f,a,u]}class He extends Z{constructor(e){super(),$(this,e,Ne,je,x,{inputValue:0})}}function Ee(r,e,n){const t=r.slice();return t[7]=e[n],t}function Ie(r,e,n){const t=r.slice();return t[10]=e[n],t}function Ye(r){let e,n,t,l,o,i,s,c=r[10].count+"",f,a,u,m,T,h,k,y,P=r[10].product.item+"",D,g,V,L=r[10].product.amountPerMinute.toFixed(2)+"",q,S,_,w=r[10].byproduct&&ye(r);return{c(){e=v("table"),n=v("tr"),t=v("td"),l=v("div"),o=A("Count"),i=M(),s=v("div"),f=A(c),a=M(),u=v("td"),m=v("div"),T=v("img"),k=M(),y=v("div"),D=A(P),g=M(),V=v("td"),q=A(L),S=A(" / min"),_=M(),w&&w.c(),this.h()},l(G){e=b(G,"TABLE",{class:!0});var R=E(e);n=b(R,"TR",{});var U=E(n);t=b(U,"TD",{rowspan:!0,class:!0});var J=E(t);l=b(J,"DIV",{});var ue=E(l);o=F(ue,"Count"),ue.forEach(p),i=C(J),s=b(J,"DIV",{});var ce=E(s);f=F(ce,c),ce.forEach(p),J.forEach(p),a=C(U),u=b(U,"TD",{class:!0});var K=E(u);m=b(K,"DIV",{});var ae=E(m);T=b(ae,"IMG",{src:!0,alt:!0,class:!0}),ae.forEach(p),k=C(K),y=b(K,"DIV",{});var fe=E(y);D=F(fe,P),fe.forEach(p),K.forEach(p),g=C(U),V=b(U,"TD",{class:!0});var ee=E(V);q=F(ee,L),S=F(ee," / min"),ee.forEach(p),U.forEach(p),_=C(R),w&&w.l(R),R.forEach(p),this.h()},h(){I(t,"rowspan","2"),I(t,"class","svelte-427c5w"),z(T.src,h=r[0][r[10].product.item])||I(T,"src",h),I(T,"alt",""),I(T,"class","svelte-427c5w"),I(u,"class","item svelte-427c5w"),I(V,"class","amount svelte-427c5w"),I(e,"class","itemnode svelte-427c5w")},m(G,R){O(G,e,R),d(e,n),d(n,t),d(t,l),d(l,o),d(t,i),d(t,s),d(s,f),d(n,a),d(n,u),d(u,m),d(m,T),d(u,k),d(u,y),d(y,D),d(n,g),d(n,V),d(V,q),d(V,S),d(e,_),w&&w.m(e,null)},p(G,R){R&2&&c!==(c=G[10].count+"")&&B(f,c),R&3&&!z(T.src,h=G[0][G[10].product.item])&&I(T,"src",h),R&2&&P!==(P=G[10].product.item+"")&&B(D,P),R&2&&L!==(L=G[10].product.amountPerMinute.toFixed(2)+"")&&B(q,L),G[10].byproduct?w?w.p(G,R):(w=ye(G),w.c(),w.m(e,null)):w&&(w.d(1),w=null)},d(G){G&&p(e),w&&w.d()}}}function ze(r){let e=r[10]+"",n;return{c(){n=A(e)},l(t){n=F(t,e)},m(t,l){O(t,n,l)},p(t,l){l&2&&e!==(e=t[10]+"")&&B(n,e)},d(t){t&&p(n)}}}function ye(r){let e,n,t,l,o,i,s,c=r[10].byproduct.item+"",f,a,u,m=r[10].byproduct.amountPerMinute.toFixed(2)+"",T,h;return{c(){e=v("tr"),n=v("td"),t=v("div"),l=v("img"),i=M(),s=v("div"),f=A(c),a=M(),u=v("td"),T=A(m),h=A(" / min"),this.h()},l(k){e=b(k,"TR",{});var y=E(e);n=b(y,"TD",{class:!0});var P=E(n);t=b(P,"DIV",{});var D=E(t);l=b(D,"IMG",{src:!0,alt:!0,class:!0}),D.forEach(p),i=C(P),s=b(P,"DIV",{});var g=E(s);f=F(g,c),g.forEach(p),P.forEach(p),a=C(y),u=b(y,"TD",{class:!0});var V=E(u);T=F(V,m),h=F(V," / min"),V.forEach(p),y.forEach(p),this.h()},h(){z(l.src,o=r[0][r[10].byproduct.item])||I(l,"src",o),I(l,"alt",""),I(l,"class","svelte-427c5w"),I(n,"class","svelte-427c5w"),I(u,"class","svelte-427c5w")},m(k,y){O(k,e,y),d(e,n),d(n,t),d(t,l),d(n,i),d(n,s),d(s,f),d(e,a),d(e,u),d(u,T),d(u,h)},p(k,y){y&3&&!z(l.src,o=k[0][k[10].byproduct.item])&&I(l,"src",o),y&2&&c!==(c=k[10].byproduct.item+"")&&B(f,c),y&2&&m!==(m=k[10].byproduct.amountPerMinute.toFixed(2)+"")&&B(T,m)},d(k){k&&p(e)}}}function we(r){let e;function n(o,i){return typeof o[10]=="string"?ze:Ye}let t=n(r),l=t(r);return{c(){e=v("td"),l.c(),this.h()},l(o){e=b(o,"TD",{class:!0});var i=E(e);l.l(i),i.forEach(p),this.h()},h(){I(e,"class","outer svelte-427c5w")},m(o,i){O(o,e,i),l.m(e,null)},p(o,i){t===(t=n(o))&&l?l.p(o,i):(l.d(1),l=t(o),l&&(l.c(),l.m(e,null)))},d(o){o&&p(e),l.d()}}}function ke(r){let e,n,t=r[7],l=[];for(let o=0;o<t.length;o+=1)l[o]=we(Ie(r,t,o));return{c(){e=v("tr");for(let o=0;o<l.length;o+=1)l[o].c();n=M()},l(o){e=b(o,"TR",{});var i=E(e);for(let s=0;s<l.length;s+=1)l[s].l(i);n=C(i),i.forEach(p)},m(o,i){O(o,e,i);for(let s=0;s<l.length;s+=1)l[s]&&l[s].m(e,null);d(e,n)},p(o,i){if(i&3){t=o[7];let s;for(s=0;s<t.length;s+=1){const c=Ie(o,t,s);l[s]?l[s].p(c,i):(l[s]=we(c),l[s].c(),l[s].m(e,n))}for(;s<l.length;s+=1)l[s].d(1);l.length=t.length}},d(o){o&&p(e),W(l,o)}}}function Qe(r){let e,n,t,l,o,i,s=r[1],c=[];for(let f=0;f<s.length;f+=1)c[f]=ke(Ee(r,s,f));return{c(){e=v("div"),n=v("h2"),t=A("Production Graph (Scrollable)"),l=M(),o=v("table"),i=v("tbody");for(let f=0;f<c.length;f+=1)c[f].c();this.h()},l(f){e=b(f,"DIV",{class:!0});var a=E(e);n=b(a,"H2",{class:!0});var u=E(n);t=F(u,"Production Graph (Scrollable)"),u.forEach(p),l=C(a),o=b(a,"TABLE",{});var m=E(o);i=b(m,"TBODY",{});var T=E(i);for(let h=0;h<c.length;h+=1)c[h].l(T);T.forEach(p),m.forEach(p),a.forEach(p),this.h()},h(){I(n,"class","svelte-427c5w"),I(e,"class","TopDownGraphDiv svelte-427c5w")},m(f,a){O(f,e,a),d(e,n),d(n,t),d(e,l),d(e,o),d(o,i);for(let u=0;u<c.length;u+=1)c[u]&&c[u].m(i,null)},p(f,[a]){if(a&3){s=f[1];let u;for(u=0;u<s.length;u+=1){const m=Ee(f,s,u);c[u]?c[u].p(m,a):(c[u]=ke(m),c[u].c(),c[u].m(i,null))}for(;u<c.length;u+=1)c[u].d(1);c.length=s.length}},i:Y,o:Y,d(f){f&&p(e),W(c,f)}}}function Ve(r){return r.ingredients.length==0?1:r.ingredients.map(e=>Ve(e)).reduce((e,n)=>e+n,0)}function We(r,e,n){let{selectedItem:t=""}=e,{images:l}=e,{productionTree:o}=e,i=[[]],s,c;function f(a,u=0){const m=a.product,T=Q[m.item],h=(s-T)*2;if(n(1,i[u][h]=a,i),a.ingredients.length==0)return u;let k=u-1;for(const y of a.ingredients){const P=k+1;k=f(y,P);const D=(s-Q[y.product.item])*2;for(let g=h+1;g<D;g++)n(1,i[P][g]="─",i)}do{const y=h+1;let P=u,D=u;for(let g=u;g<=k;g++)i[g][y]==="─"&&(D=g);if(P==D)break;for(let g=u;g<=k;g++)if(!i[g][y])n(1,i[g][y]="│",i);else if(g==P)n(1,i[g][y]="┌",i);else if(g==D){n(1,i[g][y]="└",i);break}else n(1,i[g][y]="├",i)}while(!1);return k}return r.$$set=a=>{"selectedItem"in a&&n(3,t=a.selectedItem),"images"in a&&n(0,l=a.images),"productionTree"in a&&n(2,o=a.productionTree)},r.$$.update=()=>{r.$$.dirty&60&&t&&(n(2,o=De(t)),n(4,s=Q[o.product.item]),n(5,c=Ve(o)),n(1,i=Array(c).fill(null).map(()=>Array(s*2+1).fill(""))),f(o))},[l,i,o,t,s,c]}class Je extends Z{constructor(e){super(),$(this,e,We,Qe,x,{selectedItem:3,images:0,productionTree:2})}}function Ke(r){let e,n,t,l,o,i,s,c,f,a,u,m,T,h;function k(_){r[5](_)}let y={};r[2]!==void 0&&(y.inputValue=r[2]),t=new He({props:y}),j.push(()=>N(t,"inputValue",k)),t.$on("submit",r[4]);function P(_){r[6](_)}function D(_){r[7](_)}function g(_){r[8](_)}let V={};r[3]!==void 0&&(V.selectedItem=r[3]),r[1]!==void 0&&(V.productionTree=r[1]),r[0].images!==void 0&&(V.images=r[0].images),i=new Je({props:V}),j.push(()=>N(i,"selectedItem",P)),j.push(()=>N(i,"productionTree",D)),j.push(()=>N(i,"images",g));function L(_){r[9](_)}function q(_){r[10](_)}let S={};return r[1]!==void 0&&(S.productionTree=r[1]),r[0].images!==void 0&&(S.images=r[0].images),u=new qe({props:S}),j.push(()=>N(u,"productionTree",L)),j.push(()=>N(u,"images",q)),{c(){e=v("meta"),n=M(),te(t.$$.fragment),o=M(),te(i.$$.fragment),a=M(),te(u.$$.fragment),this.h()},l(_){const w=Re("svelte-qbpr0x",document.head);e=b(w,"META",{name:!0,content:!0}),w.forEach(p),n=C(_),ne(t.$$.fragment,_),o=C(_),ne(i.$$.fragment,_),a=C(_),ne(u.$$.fragment,_),this.h()},h(){document.title="TopDown",I(e,"name","description"),I(e,"content","Top Down Production Chain Graph")},m(_,w){d(document.head,e),O(_,n,w),le(t,_,w),O(_,o,w),le(i,_,w),O(_,a,w),le(u,_,w),h=!0},p(_,[w]){const G={};!l&&w&4&&(l=!0,G.inputValue=_[2],H(()=>l=!1)),t.$set(G);const R={};!s&&w&8&&(s=!0,R.selectedItem=_[3],H(()=>s=!1)),!c&&w&2&&(c=!0,R.productionTree=_[1],H(()=>c=!1)),!f&&w&1&&(f=!0,R.images=_[0].images,H(()=>f=!1)),i.$set(R);const U={};!m&&w&2&&(m=!0,U.productionTree=_[1],H(()=>m=!1)),!T&&w&1&&(T=!0,U.images=_[0].images,H(()=>T=!1)),u.$set(U)},i(_){h||(ie(t.$$.fragment,_),ie(i.$$.fragment,_),ie(u.$$.fragment,_),h=!0)},o(_){re(t.$$.fragment,_),re(i.$$.fragment,_),re(u.$$.fragment,_),h=!1},d(_){p(e),_&&p(n),oe(t,_),_&&p(o),oe(i,_),_&&p(a),oe(u,_)}}}function Xe(r,e,n){let{data:t}=e,l,o="",i="";function s(){o&&t.items.includes(o)&&n(3,i=o)}function c(h){o=h,n(2,o)}function f(h){i=h,n(3,i)}function a(h){l=h,n(1,l)}function u(h){r.$$.not_equal(t.images,h)&&(t.images=h,n(0,t))}function m(h){l=h,n(1,l)}function T(h){r.$$.not_equal(t.images,h)&&(t.images=h,n(0,t))}return r.$$set=h=>{"data"in h&&n(0,t=h.data)},[t,l,o,i,s,c,f,a,u,m,T]}class et extends Z{constructor(e){super(),$(this,e,Xe,Ke,x,{data:0})}}export{et as default};
